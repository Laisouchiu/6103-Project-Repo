<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Team 9">

<title>Property Sales Price Prediction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Summary Paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="Summary Paper_files/libs/quarto-html/quarto.js"></script>
<script src="Summary Paper_files/libs/quarto-html/popper.min.js"></script>
<script src="Summary Paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Summary Paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="Summary Paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Summary Paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Summary Paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Summary Paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Summary Paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Property Sales Price Prediction</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Team 9 </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="research-topic" class="level1">
<h1>Research Topic</h1>
<p>We are analyzing a selling record dataset from the New York City property market, which includes annual selling records of single buildings or unit buildings from 2016 to 2017. We are going to analyze the different factors present in our dataset to predict the sales price of the building in New York City. The aim of this project is to find relations and patterns of sales price w.r.t. various other factors to have a clear understanding of property price in NYC, and hopefully will help property companies or citizens that has interest in purchasing property at New York to have a prospect for the NY property price trend in the future.</p>
</section>
<section id="smart-questions" class="level1">
<h1>SMART Questions:</h1>
<ul>
<li>What type(s) of location variable(s) (Eg. block, borough, neighborhood) will affect the selling price most? (can answer by modeling)<br>
</li>
<li>How is the sale price of commercial property different from the sale price of residential property?<br>
</li>
<li>How is accuracy different if different machine learning models like linear regression, logistic regression, and random forest are applied?<br>
</li>
</ul>
</section>
<section id="importing-libraries" class="level1">
<h1>Importing Libraries</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data" class="level1">
<h1>Importing Data</h1>
<p>We imported the data about New York properties and checked its basic information</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"Team9_data.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.shape)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(84548, 22)
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84548 entries, 0 to 84547
Data columns (total 22 columns):
 #   Column                          Non-Null Count  Dtype 
---  ------                          --------------  ----- 
 0   Unnamed: 0                      84548 non-null  int64 
 1   BOROUGH                         84548 non-null  int64 
 2   NEIGHBORHOOD                    84548 non-null  object
 3   BUILDING CLASS CATEGORY         84548 non-null  object
 4   TAX CLASS AT PRESENT            84548 non-null  object
 5   BLOCK                           84548 non-null  int64 
 6   LOT                             84548 non-null  int64 
 7   EASE-MENT                       84548 non-null  object
 8   BUILDING CLASS AT PRESENT       84548 non-null  object
 9   ADDRESS                         84548 non-null  object
 10  APARTMENT NUMBER                84548 non-null  object
 11  ZIP CODE                        84548 non-null  int64 
 12  RESIDENTIAL UNITS               84548 non-null  int64 
 13  COMMERCIAL UNITS                84548 non-null  int64 
 14  TOTAL UNITS                     84548 non-null  int64 
 15  LAND SQUARE FEET                84548 non-null  object
 16  GROSS SQUARE FEET               84548 non-null  object
 17  YEAR BUILT                      84548 non-null  int64 
 18  TAX CLASS AT TIME OF SALE       84548 non-null  int64 
 19  BUILDING CLASS AT TIME OF SALE  84548 non-null  object
 20  SALE PRICE                      84548 non-null  object
 21  SALE DATE                       84548 non-null  object
dtypes: int64(10), object(12)
memory usage: 14.2+ MB
None</code></pre>
</div>
</div>
<p>This dataset has 84,548 rows and 22 columns</p>
</section>
<section id="dataset-pre-processing" class="level1">
<h1>Dataset Pre-Processing</h1>
<p>Before we do the EDA and build models for this dataset, we need to clean the data first</p>
<section id="columns-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="columns-manipulation">Columns Manipulation</h2>
<section id="changing-columns-name" class="level3">
<h3 class="anchored" data-anchor-id="changing-columns-name">Changing Column’s Name</h3>
<p>We changed the columns name into lower capital for better visualization and convenience.&nbsp;</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>newcols <span class="op">=</span> [<span class="st">"unnamed"</span>, <span class="st">"borough"</span>, <span class="st">"neighborhood"</span>, <span class="st">"building_class_category"</span>, <span class="st">"tax_class_at_present"</span>, <span class="st">"block"</span>, <span class="st">"lot"</span>, <span class="st">"easement"</span>, <span class="st">"building_class_at_present"</span>, <span class="st">"address"</span>, <span class="st">"apartment_number"</span>, <span class="st">"zip_code"</span>, <span class="st">"residential_units"</span>, <span class="st">"commercial_units"</span>, <span class="st">"total_units"</span>, <span class="st">"land_square_feet"</span>, <span class="st">"gross_square_feet"</span>, <span class="st">"year_built"</span>, <span class="st">"tax_class_at_time_of_sale"</span>, <span class="st">"building_class_at_time_of_sale"</span>, <span class="st">"sale_price"</span>, <span class="st">"sale_date"</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data.columns <span class="op">=</span> newcols</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 84548 entries, 0 to 84547
Data columns (total 22 columns):
 #   Column                          Non-Null Count  Dtype 
---  ------                          --------------  ----- 
 0   unnamed                         84548 non-null  int64 
 1   borough                         84548 non-null  int64 
 2   neighborhood                    84548 non-null  object
 3   building_class_category         84548 non-null  object
 4   tax_class_at_present            84548 non-null  object
 5   block                           84548 non-null  int64 
 6   lot                             84548 non-null  int64 
 7   easement                        84548 non-null  object
 8   building_class_at_present       84548 non-null  object
 9   address                         84548 non-null  object
 10  apartment_number                84548 non-null  object
 11  zip_code                        84548 non-null  int64 
 12  residential_units               84548 non-null  int64 
 13  commercial_units                84548 non-null  int64 
 14  total_units                     84548 non-null  int64 
 15  land_square_feet                84548 non-null  object
 16  gross_square_feet               84548 non-null  object
 17  year_built                      84548 non-null  int64 
 18  tax_class_at_time_of_sale       84548 non-null  int64 
 19  building_class_at_time_of_sale  84548 non-null  object
 20  sale_price                      84548 non-null  object
 21  sale_date                       84548 non-null  object
dtypes: int64(10), object(12)
memory usage: 14.2+ MB</code></pre>
</div>
</div>
</section>
<section id="changing-columns-data-type" class="level3">
<h3 class="anchored" data-anchor-id="changing-columns-data-type">Changing column’s data type</h3>
<p>There are too many columns with inappropriate data type, so we need to convert them to the appropriate data type:</p>
<ol type="1">
<li>We converted land and gross square feet, property sales price, the number of residential, commercial and total units into continous variables<br>
</li>
<li>We converted variables that represent different locations like borough, neighborhood and zip code into categorical variable; we also converted variables represented different building categories, and different building tax categories into categorical variables<br>
</li>
</ol>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>numeric <span class="op">=</span> [<span class="st">"residential_units"</span>,<span class="st">"commercial_units"</span>,<span class="st">"total_units"</span>, <span class="st">"land_square_feet"</span> ,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"gross_square_feet"</span>,<span class="st">"sale_price"</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> numeric: </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    data[col] <span class="op">=</span> pd.to_numeric(data[col], errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>categorical <span class="op">=</span> [<span class="st">"borough"</span>,<span class="st">"neighborhood"</span>,<span class="st">'building_class_category'</span>, <span class="st">'tax_class_at_present'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'building_class_at_present'</span>,<span class="st">'zip_code'</span>, <span class="st">'building_class_at_time_of_sale'</span>, <span class="st">'tax_class_at_time_of_sale'</span>]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical: </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    data[col] <span class="op">=</span> data[col].astype(<span class="st">'category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-some-new-features" class="level3">
<h3 class="anchored" data-anchor-id="creating-some-new-features">Creating Some New Features:</h3>
<p>We created a new column for percentage of residential units</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"percent_residential_units"</span>] <span class="op">=</span> data[<span class="st">"residential_units"</span>] <span class="op">/</span> data[<span class="st">"total_units"</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Three lines are greater than one - not possible is likely due to discrepencies in the data so we can drop those</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span> data.loc[data[<span class="st">"percent_residential_units"</span>] <span class="op">!=</span> <span class="dv">6</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span> data.loc[data[<span class="st">"percent_residential_units"</span>] <span class="op">!=</span> <span class="dv">2</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span> data.loc[data[<span class="st">"percent_residential_units"</span>] <span class="op">!=</span> <span class="fl">1.5</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'percent_residential_units'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>1.000000    57072
0.000000     5021
0.666667      908
0.500000      560
0.750000      232
            ...  
0.991453        1
0.468750        1
0.986631        1
0.346154        1
0.940000        1
Name: percent_residential_units, Length: 180, dtype: int64</code></pre>
</div>
</div>
<p>We created another new column named ‘age’ by calculating the difference between the current year and the year it was built<br>
</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data[data[<span class="st">'year_built'</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'age'</span>] <span class="op">=</span> <span class="dv">2022</span> <span class="op">-</span> data[<span class="st">'year_built'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dropping-insignificant-columns" class="level3">
<h3 class="anchored" data-anchor-id="dropping-insignificant-columns">Dropping Insignificant Columns</h3>
<p>Based on the dataset information, we can see there’s an ambiguous column called ‘Unnamed’ that we don’t know what it’s used for, and another useless column ‘easement’ which has no value in its column for our analysis of sales price, so we decided to drop them first<br>
</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data.drop(<span class="st">"unnamed"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols.drop(<span class="st">"easement"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because we created a new feature called “age”, which is a better representation for the measure of a property’s history, so we can drop the column ‘year_built’</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols.drop([<span class="st">'year_built'</span>], axis <span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we dropped some other columns too which had the same meaning as other columns.<br>
</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols.drop([<span class="st">'apartment_number'</span>,<span class="st">'building_class_at_present'</span>, <span class="st">'tax_class_at_present'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsetting-out-inappropriate-values" class="level3">
<h3 class="anchored" data-anchor-id="subsetting-out-inappropriate-values">Subsetting Out Inappropriate Values</h3>
<p>Dropping duplicates<br>
</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data_few_cols.drop_duplicates(keep <span class="op">=</span> <span class="st">"last"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Removing data where commercial + residential doesn’t equal to total units</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols[data_few_cols[<span class="st">'total_units'</span>] <span class="op">==</span> data_few_cols[<span class="st">'commercial_units'</span>] <span class="op">+</span> data_few_cols[<span class="st">'residential_units'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Removing rows with TOTAL UNITS == 0 and one outlier with 2261 units<br>
</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols[(data_few_cols[<span class="st">'total_units'</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (data_few_cols[<span class="st">'total_units'</span>] <span class="op">!=</span> <span class="dv">2261</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Removing 0 square foot units<br>
</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols[data_few_cols[<span class="st">"land_square_feet"</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols[data_few_cols[<span class="st">"gross_square_feet"</span>] <span class="op">!=</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="dropping-null-values" class="level2">
<h2 class="anchored" data-anchor-id="dropping-null-values">Dropping Null Values</h2>
<p>After we finish the column manipulation, convert columns into appropriate data type, drop useless columns and create some new features, then we can drop the null or missing values in the whole dataset.<br>
</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_few_cols <span class="op">=</span> data_few_cols.dropna()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data_few_cols.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 36420 entries, 0 to 84547
Data columns (total 18 columns):
 #   Column                          Non-Null Count  Dtype   
---  ------                          --------------  -----   
 0   borough                         36420 non-null  category
 1   neighborhood                    36420 non-null  category
 2   building_class_category         36420 non-null  category
 3   block                           36420 non-null  int64   
 4   lot                             36420 non-null  int64   
 5   address                         36420 non-null  object  
 6   zip_code                        36420 non-null  category
 7   residential_units               36420 non-null  int64   
 8   commercial_units                36420 non-null  int64   
 9   total_units                     36420 non-null  int64   
 10  land_square_feet                36420 non-null  float64 
 11  gross_square_feet               36420 non-null  float64 
 12  tax_class_at_time_of_sale       36420 non-null  category
 13  building_class_at_time_of_sale  36420 non-null  category
 14  sale_price                      36420 non-null  float64 
 15  sale_date                       36420 non-null  object  
 16  percent_residential_units       36420 non-null  float64 
 17  age                             36420 non-null  int64   
dtypes: category(6), float64(4), int64(6), object(2)
memory usage: 3.9+ MB</code></pre>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis-eda-visualization" class="level1">
<h1>Exploratory Data Analysis (EDA) &amp; Visualization</h1>
<section id="correlation-matrix" class="level2">
<h2 class="anchored" data-anchor-id="correlation-matrix">Correlation Matrix</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> data_few_cols.corr()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(corr, cmap <span class="op">=</span> <span class="st">'Blues'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation Matrix"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\LENOVO\AppData\Local\Temp\ipykernel_30996\3853464610.py:1: FutureWarning: The default value of numeric_only in DataFrame.corr is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.
  corr = data_few_cols.corr()</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-16-output-2.png" width="698" height="585"></p>
</div>
</div>
<ul>
<li>According to the correlation matrix, we can see gross_square_feet have the strongest positive correlation with the sales price.<br>
</li>
</ul>
</section>
<section id="sales-prices-distribution" class="level2">
<h2 class="anchored" data-anchor-id="sales-prices-distribution">Sales Prices Distribution</h2>
<p>Only plotting values less than $10 million due to significant outliers (eg. 2.2 BILLION dollars)</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plt.hist(data_few_cols.loc[data_few_cols[<span class="st">"sale_price"</span>] <span class="op">&lt;=</span> <span class="dv">10000000</span>][<span class="st">"sale_price"</span>], bins <span class="op">=</span> <span class="dv">30</span>, edgecolor <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sale Price (Millions)"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of House Sale Prices"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-17-output-1.png" width="610" height="449"></p>
</div>
</div>
<ul>
<li>Most of the properties are selling below 0.2 millions dollar in New York from 2016 to 2017.<br>
</li>
</ul>
</section>
<section id="different-districts-selling-prices" class="level2">
<h2 class="anchored" data-anchor-id="different-districts-selling-prices">Different Districts Selling Prices</h2>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>borough_map <span class="op">=</span> {<span class="dv">1</span>: <span class="st">"Manhattan"</span>, <span class="dv">2</span>: <span class="st">"Bronx"</span>, <span class="dv">3</span>: <span class="st">"Brooklyn"</span>, <span class="dv">4</span>: <span class="st">"Queens"</span>, <span class="dv">5</span>:<span class="st">"Staten Island"</span>}</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data_few_cols[<span class="st">"borough"</span>] <span class="op">=</span> data_few_cols.borough.<span class="bu">map</span>(borough_map)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>data_borough <span class="op">=</span> data_few_cols[[<span class="st">"borough"</span>, <span class="st">"sale_price"</span>]].groupby([<span class="st">"borough"</span>]).mean()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> data_borough.index.values</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> data_borough[<span class="st">'sale_price'</span>].values</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>data_borough</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.bar(labels, values, edgecolor <span class="op">=</span> <span class="st">"black"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xticklabels(("Manhattan", "Bronx", "Brooklyn", "Queens", "Staten Island"))</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Average Sale Price (Millions)"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Borough"</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Average Sale Price by Borough"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-18-output-1.png" width="597" height="449"></p>
</div>
</div>
<ul>
<li>From the plot we can see that Manhattan property price is much higher than the other boroughs, so Manhattan is the most expensive district in New York.<br>
</li>
</ul>
</section>
<section id="violinplot-for-price-and-borough" class="level2">
<h2 class="anchored" data-anchor-id="violinplot-for-price-and-borough">Violinplot for price and borough</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x <span class="op">=</span> <span class="st">"borough"</span>, y <span class="op">=</span> <span class="st">"sale_price"</span>, data <span class="op">=</span> data_few_cols.loc[data_few_cols[<span class="st">"sale_price"</span>] <span class="op">&lt;=</span> <span class="dv">10000000</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of Sale Price by Borough"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Borough"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Sale Price"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-19-output-1.png" width="600" height="449"></p>
</div>
</div>
<ul>
<li>From the violinplot, we can see that Manhattan is much skinnier as compared to others but it stretches to higher sales price.<br>
</li>
<li>Skinny plot represents that there is no specific price range in which Manhattan properties are getting sold.<br>
</li>
<li>Rest all the boroughs are fatter in lower sales price region.<br>
</li>
</ul>
</section>
<section id="plotting-square-footage-for-10k-and-those-not-equal-to-zero" class="level2">
<h2 class="anchored" data-anchor-id="plotting-square-footage-for-10k-and-those-not-equal-to-zero">Plotting Square Footage for &lt; 10k and those not equal to zero</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_few_cols_gross <span class="op">=</span> data_few_cols.loc[data_few_cols[<span class="st">"gross_square_feet"</span>] <span class="op">&lt;</span> <span class="dv">10000</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_few_cols_gross <span class="op">=</span> data_few_cols_gross.loc[data_few_cols[<span class="st">"gross_square_feet"</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plt.hist(data_few_cols_gross[<span class="st">"gross_square_feet"</span>], bins <span class="op">=</span> <span class="dv">30</span>, edgecolor <span class="op">=</span> <span class="st">"black"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Gross Square Feet"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of Gross Square Footage"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-20-output-1.png" width="601" height="449"></p>
</div>
</div>
<ul>
<li>The right skewed histogram indicating there are less values in upper end of the gross_square_feet.<br>
</li>
</ul>
</section>
<section id="square-footage-and-sale-price" class="level2">
<h2 class="anchored" data-anchor-id="square-footage-and-sale-price">Square Footage and Sale Price</h2>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data_few_cols_gross <span class="op">=</span> data_few_cols_gross.loc[data_few_cols_gross[<span class="st">"sale_price"</span>] <span class="op">&lt;=</span> <span class="dv">20000000</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x <span class="op">=</span> <span class="st">"gross_square_feet"</span>, y <span class="op">=</span> <span class="st">"sale_price"</span>, data <span class="op">=</span> data_few_cols_gross, scatter_kws<span class="op">=</span>{<span class="st">"alpha"</span>: <span class="fl">0.2</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Square Footage versus Sale Price"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Square Footage"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Sale Price"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-21-output-1.png" width="470" height="476"></p>
</div>
</div>
<ul>
<li>The data points are very scattered are not aligning very well with the straight line.<br>
</li>
</ul>
</section>
<section id="age-and-sale-price" class="level2">
<h2 class="anchored" data-anchor-id="age-and-sale-price">Age and Sale Price</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x <span class="op">=</span> <span class="st">"age"</span>, y <span class="op">=</span> <span class="st">"sale_price"</span>, data <span class="op">=</span> data_few_cols.loc[data_few_cols[<span class="st">"sale_price"</span>] <span class="op">&lt;=</span> <span class="dv">10000000</span>], scatter_kws<span class="op">=</span>{<span class="st">'alpha'</span>: <span class="fl">0.2</span>}, line_kws<span class="op">=</span>{<span class="st">'color'</span>: <span class="st">'red'</span>})</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Age versus Sale Price"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Age (years)"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Sale Price"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-22-output-1.png" width="470" height="476"></p>
</div>
</div>
<ul>
<li>The data points are very scattered are not aligning very well with the straight line.<br>
</li>
</ul>
</section>
<section id="total-units-and-sale-price" class="level2">
<h2 class="anchored" data-anchor-id="total-units-and-sale-price">Total Units and Sale Price</h2>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_low <span class="op">=</span> data_few_cols.loc[data_few_cols[<span class="st">"sale_price"</span>] <span class="op">&lt;=</span> <span class="dv">10000000</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x <span class="op">=</span> <span class="st">"total_units"</span>, y <span class="op">=</span> <span class="st">"sale_price"</span>, data <span class="op">=</span> data_low.loc[data_low[<span class="st">'total_units'</span>] <span class="op">&lt;</span> <span class="dv">500</span>])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>, <span class="dv">10000000</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-23-output-1.png" width="470" height="470"></p>
</div>
</div>
<ul>
<li>We can see that there is a linear relation of total_units but it is not very clear as there are a lot of outliers.<br>
</li>
</ul>
</section>
<section id="selling-price-at-different-tax-classes" class="level2">
<h2 class="anchored" data-anchor-id="selling-price-at-different-tax-classes">Selling Price at Different Tax Classes</h2>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tax_class <span class="op">=</span> data_few_cols[[<span class="st">"sale_price"</span>, <span class="st">"tax_class_at_time_of_sale"</span>]].groupby([<span class="st">"tax_class_at_time_of_sale"</span>]).mean()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> tax_class.index.values.astype(<span class="bu">str</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> tax_class.sale_price.values</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tax_class</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>plt.bar(labels, values)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Sale Price by Tax Class"</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tax Class"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Sale Price"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-24-output-1.png" width="576" height="449"></p>
</div>
</div>
<ul>
<li>This plot gives valuable insights with respect to different tax classes. Properties with tax class 4 has the highest selling price.<br>
</li>
</ul>
</section>
<section id="distribution-of-percent-residential-units" class="level2">
<h2 class="anchored" data-anchor-id="distribution-of-percent-residential-units">Distribution of Percent Residential Units</h2>
<p>Not very informative but interesting as most buildings are 100% residential.<br>
</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plt.hist(data_few_cols[<span class="st">"percent_residential_units"</span>], bins <span class="op">=</span> <span class="dv">40</span>, edgecolor <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of Percent of Residential Units"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Percent Residential"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-25-output-1.png" width="610" height="449"></p>
</div>
</div>
</section>
</section>
<section id="model-building" class="level1">
<h1>Model Building</h1>
<p>We are going to build 4 models for predicting the sales_price of New York property, which are:<br>
</p>
<ul>
<li>Linear Regression<br>
</li>
<li>Decision Tree<br>
</li>
<li>Random Forest<br>
</li>
<li>K-NN<br>
The variables we are going to use are:<br>
borough, building_class_category, zip_codes, total_units, percent_residential_units, age, gross_square_feet, tax_class_at_time_of_sale, building_class_at_time_of_sale, and sale_price as the response variable.<br>
The variables we don’t use:<br>
We didn’t use Neighborhood, block, lot and address because they have the similar information as zip_codes and borough, and we think zip_codes and borough can provide better information on location.<br>
We didn’t use land_square_feet because we decided to use gross_sqaure_feet as a better variable for measuring the area.<br>
</li>
</ul>
<section id="removing-outliers" class="level2">
<h2 class="anchored" data-anchor-id="removing-outliers">Removing Outliers</h2>
<p>Because in the EDA Section, we’ve already seen our response variable sale_price is highly right skewed, so before we build the models, we have to remove the outliers or the model will be meaningless.<br>
We defined a function for detecting outliers, of which setting our outliers quantile below 25% and over 75%.<br>
</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>outliers_indexes <span class="op">=</span> []</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> outliers (df, ft):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    q1<span class="op">=</span>df[ft].quantile(<span class="fl">0.25</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    q3<span class="op">=</span>df[ft].quantile(<span class="fl">0.75</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    iqr<span class="op">=</span>q3<span class="op">-</span>q1</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    lower_bound<span class="op">=</span>q1<span class="op">-</span><span class="fl">1.5</span><span class="op">*</span>iqr</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    upper_bound<span class="op">=</span>q3<span class="op">+</span><span class="fl">1.5</span><span class="op">*</span>iqr</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    outliers<span class="op">=</span>df.index[ (df[ft]<span class="op">&lt;</span>lower_bound) <span class="op">|</span> (df[ft]<span class="op">&gt;</span>upper_bound)]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outliers</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>outliers_indexes.extend(outliers(data_few_cols, <span class="st">'sale_price'</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of outliers:'</span>, <span class="bu">len</span>(outliers_indexes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of outliers: 2743</code></pre>
</div>
</div>
<p>Define another function for removing outliers for dataframe.<br>
</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> outliers_remove(df, <span class="bu">list</span>):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span> <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(<span class="bu">list</span>)) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    df_clean <span class="op">=</span> df.drop(<span class="bu">list</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_clean</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>clean_df <span class="op">=</span> outliers_remove(data_few_cols, outliers_indexes)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>clean_df <span class="op">=</span> clean_df.loc[clean_df[<span class="st">"sale_price"</span>] <span class="op">&gt;</span> <span class="dv">10</span>]</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Shape of our final cleaned dataframe is:'</span>, clean_df.shape)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Basic info of our final cleand dataframe:</span><span class="ch">\n</span><span class="st">'</span>, clean_df.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of our final cleaned dataframe is: (25744, 18)
&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 25744 entries, 222 to 84547
Data columns (total 18 columns):
 #   Column                          Non-Null Count  Dtype   
---  ------                          --------------  -----   
 0   borough                         25744 non-null  category
 1   neighborhood                    25744 non-null  category
 2   building_class_category         25744 non-null  category
 3   block                           25744 non-null  int64   
 4   lot                             25744 non-null  int64   
 5   address                         25744 non-null  object  
 6   zip_code                        25744 non-null  category
 7   residential_units               25744 non-null  int64   
 8   commercial_units                25744 non-null  int64   
 9   total_units                     25744 non-null  int64   
 10  land_square_feet                25744 non-null  float64 
 11  gross_square_feet               25744 non-null  float64 
 12  tax_class_at_time_of_sale       25744 non-null  category
 13  building_class_at_time_of_sale  25744 non-null  category
 14  sale_price                      25744 non-null  float64 
 15  sale_date                       25744 non-null  object  
 16  percent_residential_units       25744 non-null  float64 
 17  age                             25744 non-null  int64   
dtypes: category(6), float64(4), int64(6), object(2)
memory usage: 2.8+ MB
Basic info of our final cleand dataframe:
 None</code></pre>
</div>
</div>
<p>Check the distribution of the response again.<br>
</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plt.hist(clean_df.sale_price, bins <span class="op">=</span> <span class="dv">30</span>, edgecolor <span class="op">=</span> <span class="st">"black"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Histogram of Sale Prices"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sale Price (Millions)"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Frequency"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-28-output-1.png" width="602" height="449"></p>
</div>
</div>
<p>Much cleaner plot, although not exactly normal distribution but very close to normal distribution.<br>
</p>
</section>
<section id="traintest-split" class="level2">
<h2 class="anchored" data-anchor-id="traintest-split">Train/Test Split</h2>
<p>Before we starting to build the models, we need to split our cleaned dataframe into training set and testing set.<br>
Also we transformed categorical variables using onehotencoding and scaled the variables using fit_transform() function.<br>
</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data_sold_features <span class="op">=</span> data_few_cols[[<span class="st">"borough"</span>, <span class="st">"building_class_category"</span>, <span class="st">"zip_code"</span>, <span class="st">"total_units"</span>, <span class="st">"percent_residential_units"</span>, <span class="st">"age"</span>, <span class="st">"gross_square_feet"</span>, <span class="st">"tax_class_at_time_of_sale"</span>, <span class="st">"building_class_at_time_of_sale"</span>, <span class="st">"sale_price"</span>]]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dataPreprocessor <span class="op">=</span> ColumnTransformer( transformers<span class="op">=</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        (<span class="st">"categorical"</span>, OneHotEncoder(), [<span class="st">"building_class_category"</span>, <span class="st">"tax_class_at_time_of_sale"</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"building_class_at_time_of_sale"</span>, <span class="st">"borough"</span>, <span class="st">"zip_code"</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                                          ])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#("numeric", StandardScaler(), ["total_units", "age", "sale_price", "gross_square_feet", "percent_residential_units"])</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    ], verbose_feature_names_out<span class="op">=</span><span class="va">False</span>, remainder<span class="op">=</span><span class="st">"passthrough"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>data_sold_features_newmatrix <span class="op">=</span> dataPreprocessor.fit_transform(data_sold_features)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>newcolnames <span class="op">=</span> dataPreprocessor.get_feature_names_out()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>data_sold_features_new <span class="op">=</span> pd.DataFrame( data_sold_features_newmatrix.toarray(), columns<span class="op">=</span> newcolnames )</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_sold_features_new.drop([<span class="st">"sale_price"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_sold_features_new[<span class="st">'sale_price'</span>]</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.20</span>, random_state<span class="op">=</span><span class="dv">55</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_test.shape)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.shape)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(29136, 351)
(7284, 351)
(29136,)
(7284,)</code></pre>
</div>
</div>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<p>We build the linear regression with the regressors we mentioned above at first, then we got a fitting result with 48% R-Squared value, which is not a really bad score. However, we want to make sure this is a useful model (predicting useful results), so we also need to check the model assumptions.<br>
</p>
<ul>
<li><p><strong>Normally shaped response</strong>: Because we defined two functions to remove the outliers for our response variable sale_price in the Pre-processing section and checked its distribution on the EDA section, which is approximately normally distributed so we don’t have the problem of skewed response</p></li>
<li><p><strong>Multicollinearity</strong>: We checked the VIF values for our regressors, and we found zip_code and percentage_residential_units have extremly high VIF values (about 176 and 89 subsequently), which means we have a serious problem of multicollinearity and this can make our model prediction useless, so we removed these two regressors and checked the VIF values again and finally get every VIF values in an acceptable range (below 10)</p></li>
<li><p><strong>Linearity</strong>: We checked the scatter plot between the response variable sale_price and three continuous regressors in our model structure, which are total_units, Age, and gross_square_feet. We found a clear linear relationship between property’s sales price with total units and square footage, however, we can’t see a clear linear relation between property’s sales price and property’s age. Thus firstly we decided to romove regressor Age, but this can’t increase other evaluation values, instead, it dropped our R-Squared values about 2% down, so finally we decided to keep it After we finish these checkings we build our model again with the remaining regressors: age, total_units, gross_square_feet, borough, tax_class_at_time_of_sale, building_class_at_time_of_sale, and also added two more interaction terms.</p></li>
</ul>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Final model structure </span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>lm_final <span class="op">=</span> ols(formula<span class="op">=</span><span class="st">' sale_price ~  age + total_units + gross_square_feet + C(borough) + C(tax_class_at_time_of_sale) + C(building_class_category) + age:C(building_class_category) + total_units:C(building_class_category)'</span>, data<span class="op">=</span>clean_df).fit()</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Plot</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>ypred <span class="op">=</span> lm_final.predict(clean_df)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>plt.plot(ypred, lm_final.resid, <span class="st">'o'</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color <span class="op">=</span> <span class="st">'red'</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Plot of Residuals"</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Predicted Values"</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Residuals"</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-30-output-1.png" width="600" height="449"></p>
</div>
</div>
<p>The residual plots for our final model looks acceptable.<br>
</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R_squared value:"</span>,lm_final.rsquared)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"adjusted R_squared value:"</span>,lm_final.rsquared_adj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R_squared value: 0.19761049879587889
adjusted R_squared value: 0.195360019886343</code></pre>
</div>
</div>
<p>The final linear model R-Squared value has dropped to 19.8%, which is definitely not acceptable for predicting a marketing continuous data like property sales price. Moreover, we can’t see the AIC and BIC change a lot compare with our previous model, which is also extremely high.<br>
Thus, finally we concluded that:<br>
</p>
<ul>
<li>Though we have some significant coefficients in our fitting summary, the response variable sale_price can be hardly explained with this model structure by using Linear Regression, and we will keep trying other types of models.&nbsp;</li>
</ul>
</section>
<section id="decision-tree" class="level2">
<h2 class="anchored" data-anchor-id="decision-tree">Decision Tree</h2>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> []</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> []</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>depths <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>,<span class="dv">101</span>,<span class="dv">10</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> depth <span class="kw">in</span> depths:</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    dt <span class="op">=</span> DecisionTreeRegressor(max_depth<span class="op">=</span>depth, min_samples_leaf<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    dt.fit(X_train, y_train)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    train.append(dt.score(X_train, y_train))</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    test.append(dt.score(X_test, y_test))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>plt.plot(depths, train, c <span class="op">=</span> <span class="st">"blue"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>plt.plot(depths, test, c <span class="op">=</span> <span class="st">"red"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Accuracies at Different Tree Depths"</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Max Depth"</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"R-Squared"</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-32-output-1.png" width="600" height="449"></p>
</div>
</div>
<ul>
<li>On checking R squared value for different depths of tree, accuracy fluctuated a lot and not giving a pattern. So no judgement can given by the decision tree regressor for our dataset.</li>
</ul>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<p>Random forest being a very strong modeling technique, gave better results than the previous models.<br>
We tried to run random forest using different permutations and combinations of hyperparameters.<br>
The best score model is as following<br>
</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestRegressor(max_depth<span class="op">=</span><span class="dv">10</span>, max_features<span class="op">=</span><span class="dv">10</span>,random_state <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>rf.fit(X_train,y_train)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training score:"</span>,rf.score(X_train, y_train))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Testing score:"</span>,rf.score(X_test, y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training score: 0.6440346429343455
Testing score: 0.2890256072033246</code></pre>
</div>
</div>
<p>We got the score of around 29% which is not good enough for sales price prediction but it is better than the previous techniques.<br>
</p>
</section>
<section id="k-nearest-neighbor" class="level2">
<h2 class="anchored" data-anchor-id="k-nearest-neighbor">K-Nearest Neighbor</h2>
<p>As per professor’s feedback on our presentation, we tried K-Nearest Neighbor algorithm.<br>
Since, real estate brokers, agents, and people who want to buy a property knowingly or unknowingly follow K-NN approach to find the best property for them.<br>
So, using this approach for sales price prediction models makes a huge difference.<br>
</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>acc_test <span class="op">=</span> []</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>acc_train <span class="op">=</span> []</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>, <span class="dv">35</span>):</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    knn_model <span class="op">=</span> KNeighborsRegressor(k).fit(X_train, y_train)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    score_knn_test <span class="op">=</span> knn_model.score(X_test, y_test)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    acc_test.append(score_knn_test)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print(k)</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print("test score:",score_knn_test)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    score_knn_train <span class="op">=</span> knn_model.score(X_train, y_train)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    acc_train.append(score_knn_train)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print("train Score", score_knn_train)</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#print("\n")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">4</span>,<span class="dv">35</span>), acc_test, label<span class="op">=</span><span class="st">"Testing accuracy"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Score vs K value plot for test dataset"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"K value"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>Text(0, 0.5, 'score')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Summary%20Paper_files/figure-html/cell-35-output-2.png" width="601" height="449"></p>
</div>
</div>
<ul>
<li>From the plot, R-squared score is negative initially and increasing with increasing K value at around 35% score, score values is getting saturated.<br>
</li>
<li>Best test score is achieved at K value of 23.<br>
</li>
</ul>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>knn_model <span class="op">=</span> KNeighborsRegressor(<span class="dv">23</span>).fit(X_train, y_train)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>score_knn <span class="op">=</span> knn_model.score(X_test, y_test)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Score at k = 23: "</span>,score_knn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Score at k = 23:  0.37172987602193475</code></pre>
</div>
</div>
<ul>
<li>We got the maximum score of around 37% at the k value of 23.</li>
</ul>
</section>
</section>
<section id="conclusion" class="level1">
<h1>CONCLUSION</h1>
<ul>
<li>Sales price was highly dependent on location type variables like boroughs.<br>
</li>
<li>Sales price was highly dependent on the gross_square_feet of the property.<br>
</li>
<li>Sales price was highly dependent on the tax class of the property.<br>
</li>
<li>Different models like linear regression, decision tree, random forest, and KNN gave different R squared score.<br>
</li>
<li>K-Nearest Neighbor performed best on our dataset with an score of 37%.<br>
</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>